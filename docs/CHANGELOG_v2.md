# –ñ—É—Ä–Ω–∞–ª –∏–∑–º–µ–Ω–µ–Ω–∏–π API v2.0

## üöÄ –ö—Ä—É–ø–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –≤–µ—Ä—Å–∏–∏ 2.0

### ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (Breaking Changes)

#### 1. –£–¥–∞–ª–µ–Ω Tasks API ‚ùå

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:**

- –£–¥–∞–ª–µ–Ω —ç–Ω–¥–ø–æ–∏–Ω—Ç `/tasks/` —Å–æ –≤—Å–µ–º–∏ –º–µ—Ç–æ–¥–∞–º–∏
- –£–¥–∞–ª–µ–Ω —Ñ–∞–π–ª `src/api/routes/tasks.py`
- –£–¥–∞–ª–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ `tasks` –∏–∑ –ë–î

**–ß—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ:**

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Scheduler API** (`/scheduler/tasks/`) –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –∑–∞–¥–∞—á–∞–º–∏
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ –Ω–æ–≤—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏

**–ú–∏–≥—Ä–∞—Ü–∏—è:**

```bash
# –°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–±
POST /tasks/

# –ù–æ–≤—ã–π —Å–ø–æ—Å–æ–±
POST /scheduler/tasks/
```

#### 2. –ò–∑–º–µ–Ω–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Connections API üîÑ

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:**

- –£–¥–∞–ª–µ–Ω—ã –ø–æ–ª—è –∏–∑ –ë–î: `host`, `port`, `database`, `username`
- –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –ø–æ–ª—è: `environment`, `description`, `tags`
- –í—Å–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–µ–ø–µ—Ä—å —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ Vault

**–°—Ç–∞—Ä–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```json
{
  "id": 1,
  "name": "DB",
  "host": "localhost",
  "port": 5432,
  "database": "mydb",
  "username": "user",
  "vault_path": "...",
  "is_active": true
}
```

**–ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```json
{
  "id": 1,
  "name": "DB",
  "vault_path": "secret/database/connections/db",
  "environment": "production",
  "description": "–û—Å–Ω–æ–≤–Ω–∞—è –ë–î",
  "tags": ["prod", "critical"],
  "is_active": true
}
```

#### 3. –£–ø—Ä–æ—â–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–∏–≥—Ä–∞—Ü–∏–π üìã

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:**

- –°—Ç–∞—Ä—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (V001-V005) –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –≤ 2 —Ñ–∞–π–ª–∞
- –£–¥–∞–ª–µ–Ω—ã –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –∏ –ø–æ–ª—è
- –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ –ë–î –±–µ–∑ legacy –∫–æ–¥–∞

**–ù–æ–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏:**

- `V001_init_database.sql` - –æ—Å–Ω–æ–≤–Ω–∞—è —Å—Ö–µ–º–∞ –ë–î
- `V002_test_data.sql` - —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

### ‚úÖ –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

#### 1. –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏–π

```json
{
  "environment": "production|staging|development",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è",
  "tags": ["tag1", "tag2", "tag3"]
}
```

#### 2. –£–ª—É—á—à–µ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í—Å–µ credentials —Ç–æ–ª—å–∫–æ –≤ Vault
- –ù–∏–∫–∞–∫–∏—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –ë–î
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

#### 3. –ù–æ–≤—ã–µ —Ç–∏–ø—ã –∑–∞–¥–∞—á

- `table_analysis` - –∞–Ω–∞–ª–∏–∑ —Ç–∞–±–ª–∏—Ü –∏ –∏–Ω–¥–µ–∫—Å–æ–≤
- `custom_sql` - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö SQL –∑–∞–ø—Ä–æ—Å–æ–≤

### üîß –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏

#### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

1. **–û–±–Ω–æ–≤–∏—Ç–µ API –≤—ã–∑–æ–≤—ã:**

   ```javascript
   // –°—Ç–∞—Ä–æ
   await fetch('/tasks/', { method: 'POST', ... })

   // –ù–æ–≤–æ
   await fetch('/scheduler/tasks/', { method: 'POST', ... })
   ```

2. **–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É connections:**

   ```javascript
   // –°—Ç–∞—Ä–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
   const connection = {
     name: "DB",
     host: "localhost",
     port: 5432,
     database: "mydb",
     username: "user",
     password: "pass",
   };

   // –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
   const connection = {
     name: "DB",
     vault_path: "secret/database/connections/db",
     environment: "production",
     description: "–û—Å–Ω–æ–≤–Ω–∞—è –ë–î",
     tags: ["prod"],
     // credentials —É—Ö–æ–¥—è—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–ª—è Vault
     host: "localhost",
     port: 5432,
     database: "mydb",
     username: "user",
     password: "pass",
   };
   ```

#### –î–ª—è DevOps

1. **–û–±–Ω–æ–≤–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:**

   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–æ–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ V001-V002
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Vault –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è credentials

2. **–û–±–Ω–æ–≤–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã Scheduler API
   - –û–±–Ω–æ–≤–∏—Ç–µ dashboards –¥–ª—è –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã connections

### üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** [docs/index.md](index.md)
- **Scheduler API:** [endpoints/scheduler.md](endpoints/scheduler.md)
- **Connections API:** [endpoints/connections.md](endpoints/connections.md)
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞:** [guides/scheduler_architecture_guide.md](guides/scheduler_architecture_guide.md)
